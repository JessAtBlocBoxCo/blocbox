{% extends "blocbox/base.html" %} {% load staticfiles %}
<!--this is blocbox/templates/startashipment.html -- URL is www.blocbox.co/transactions/startashipment -->

<!--load the scheduling tags-->
{% load i18n %} {% load scheduletags i18n %} {% load scheduletags %} {% block title %}Start a Shipment{% endblock %} {% block headafter %}

<script type="text/javascript">
    $(document).ready(function () {
        $('.text_container').addClass("hideit");

        $('.text_container').click(function () {
            var $this = $(this);

            if ($this.hasClass("hideit")) {
                $(this).removeClass("hideit").addClass("visible");

            } else {
                $(this).removeClass("visible").addClass("hideit");
            }
        });
    });
</script>

{% endblock %} {% block content %}

<div class="content container-fluid offwhitebackground relativediv">

    <!--top matter-->
    <p class="darkgreytext textcenter margintop40px marginbottom20px">Complete the following steps to verify shipping destination, notify your Blocbox host, and complete payment</p>
    <div class="row mobilehide">
        <div class="col-xs-8 col-xs-offset-2 nopadding">
            <p class="col-xs-3 ltbluetext textshadow textleft nopadding">1 HOST AVAILABILITY TEST PACKAGE DAYS {{ packagedays }}</p>
            <div class="col-xs-2 divline margintop10px"></div>
            <p class="col-xs-2 ltgreytext textcenter">2 PAYMENT</p>
            <div class="col-xs-2 divline margintop10px"></div>
            <p class="col-xs-3 ltgreytext textright nopadding">3 SHIP YOUR ORDER</p>
        </div>
    </div>
    <!--row for top  matter-->


    {% if host %} {% else %}
    <!--if there is not a host specified..select one-->
    <!--cSelect host and delivery address-->
    <div class="col-xs-12 col-sm-8 col-sm-offset-2 bluebackground">
        <h6 class="col-xs-12 col-sm-6 whitetext margintop15px marginsides3pct nopadding">Select Your Host and Delivery Address</h6>
    </div>
    <div class="col-xs-12 col-sm-8 col-sm-offset-2 profilebox marginbottom60px">
        <div class="row">
            <h6 class="col-xs-12 col-sm-5 marginsides3pct margintop30px marginbottom20px nopaddingleft">Select a connected host to recieve your package and confirm their address</h6>
            <div class="col-xs-12 col-sm-6 dropdown margintop30px margintop20px marginbottom30px">
                <div class="col-xs-12 col-sm-6 dropdown margintop5px marginbottom20px nomargintopmobile" id="bs-example-navbar-collapse-1">
                    <button class="selector dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown">
                        Select a Host
                        <span class="caret"></span>
                    </button>
                    <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">

                        {% for connection in connections_all %}
                        <li role="presentation">
                            <a role="menuitem" tabindex="-1" onClick="window.location='/transactions/startashipment/host{{ connection.host_user.id }}';">
      	  	    								{{ connection.host_user.first_name }} {{ connection.host_user.last_name }}: 
      	  	        						{{ connection.host_user.st_address1 }} {{ connection.host_user.st_address2 }} 	  
      	  	    						</a>
                        </li>
                        {% endfor %}
                        <li role="presentation"><a role="menuitem" tabindex="-1" onClick="window.location='/search';">Search for a New Host</a>
                        </li>
                    </ul>

                </div>
                <!--dropdown-->
            </div>
            <!--dropdown col-xs-6-->

        </div>
        <!--row-->
    </div>
    <!--profilebox-->
    {% endif %}  <!--end pick host if not specified-->

    <div class="text_container col-xs-8 col-xs-offset-2">
        <div>
            <!--div that we want to hide-->
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam blandit, eros id adipiscing congue, lorem ante sagittis elit, id malesuada nibh est sed orci</p>
        </div>
    </div>
    <!--end div_text_container-->

    <!--confirming availabiility-->
{% if host %}
 	  
 	 {% if transaction_form_submitted %}
 	 	
                 	  <div class="col-xs-12 col-sm-10 col-sm-offset-1 col-lg-8 col-lg-offset-2 bluebackground">
       										 <h6 class=" col-xs-12 col-sm-8 whitetext margintop15px marginsides3pct nopadding">
       										   Transaction Form Submitted. should redirect...
       										    	
       										 </h6>
    								</div>      
   {% else %}
   	
   	    
     {% if packagedays_count %}  <!--IF CALENDARD CHECKBOXES - SELECT PAYMETN OPTIONS -->     	
                	
                	  <div class="col-xs-12 col-sm-10 col-sm-offset-1 col-lg-8 col-lg-offset-2 bluebackground">
       										 <h6 class=" col-xs-12 col-sm-8 whitetext margintop15px marginsides3pct nopadding">
       										    Select a Payment Option {% if host %} for Sending Packages to {{ host.first_name }} {% endif %}
       										    	  TEST SHOW PACKAGE DAYS {{ packagedays }}
       										 </h6>
    								</div>

							<div class="col-xs-12 col-sm-10 col-sm-offset-1 col-lg-8 col-lg-offset-2 profilebox marginbottom60px">
                <form  action="/transactions/startashipment/host{{host.id}}/trans_submittedTrue/invoice{{invoice}}"  role="form" method="post">  
                	
											<!--
															action="/transactions/startashipment/host{{host.id}}/packagedays_count{{packagedays_count}}/"  
															action="/transactions/payment/host{{host.id}}/invoice{{invoice}}/favortype{{favortype}}/" -->

                    {% csrf_token %} {{ trans_form_package.non_field_errors }}


                    <div class="row">
                        <!--Payment option: row with the checkboxes-->
                        <div class="col-xs-12 col-sm-10 col-sm-offset-1 paddingtop20px">
                            {{ trans_form_package.payment_option.errors }}
                            <table class="table">
                                <tr>
                                    <td>
                                        <label> <input type="radio" name="payment_option" id="id_perpackage" value="perpackage">&nbsp; PER PACKAGE</label>
                                    </td>
                                    <td> <p>Pay for a single package</p>  </td>
                                    <td>   <p>${{host.price_package_per}}</p>  </td>
                                </tr>
                                <!--per package checkbox-->

                                <!--buden of 10-->
                                <tr>
                                    <td>
                                        <label> <input type="radio" name="payment_option" id="id_bundle" value="bundle10">&nbsp; BUNDLED</label>
                                    </td>
                                    <td>   <p>10 packages (expires in 1 year)</p>   </td>
                                    <td>   <p>${{host.price_package_bundle10}}</p> </td>
                                </tr>
                                <!--bundle10 checkbox-->

                                <!--Monthly-->
                                <tr>
                                    <td>
                                        <label> <input type="radio" name="payment_option" id="id_monthly" value="month20">&nbsp; MONTHLY</label>
                                    </td>
                                    <td>  <p>20 packages for the next 30 days</p> </td>
                                    <td>    <p>${{host.price_package_month20}}</p>  </td>
                                </tr>
                                <!--monthly checkbox-->

                                <!--annual-->
                                <tr>
                                    <td>
                                        <label>     <input type="radio" name="payment_option" id="id_annual" value="annual">&nbsp; ANNUAL</label>
                                    </td>
                                    <td> <p>Up to 20 packages per month for an entire year</p> </td>
                                    <td>      <p>${{host.price_package_annual}}</p>  </td>
                                </tr>
                                <!--annual checkbox-->
                            </table>
                            <!--table containg payment options -->
                        </div>
                        <!--col-sm-10 with all the checkboxes-->
                    </div>
                    <!--row with the checkboxes-->
                    <!--Enter a Transaction Tite - and add the hidden fields-->
                    <div class="row">
                        {{ trans_form_package.title.errors }}
                        <label for="id_title" class="col-xs-12 col-sm-4 col-sm-offset-1">Enter a label for this shipment (optional):</label>
                        <input class="col-xs-10 col-xs-offset-1 col-sm-5 col-sm-offset-0" type="text" name="title" class="form-control" id="id_title" placeholder="Enter a brief description of the shipment">
                    </div>
                    <div class="row paddingtop10px">
                        {{ trans_form_package.note_to_host.errors }}
                        <label for="id_note_to_host" class="col-xs-12 col-sm-4 col-sm-offset-1">Include a note for the host (optional):</label>
                        <input class="col-xs-10 col-xs-offset-1 col-sm-5 col-sm-offset-0" type="text" name="note_to_host" class="form-control" id="id_note_to_host" placeholder="Let the host know when you'll pick it up">
                    </div>



                    <!--submit button -->
                    <div class="row">
                        <div class="col-xs-12 col-sm-8 col-sm-offset-2 paddingtopbottom30px">
                            <button type="submit" name="submit" class="bluebutton">Verify and Provide Payment Information</button>
                        </div>
                    </div>
                    <!--row with submit button-->

                </form>
                 


      {% else %} <!--END IF CALENDAR BOXES CHECKED/ START IF CLAENDAR CHECKBOXES NOT CHEKCED YET -->




    <div class="col-xs-12 col-sm-10 col-sm-offset-1 col-lg-8 col-lg-offset-2 bluebackground">
        <h6 class=" col-xs-12 col-sm-8 whitetext margintop15px marginsides3pct nopadding">Confirm {{host.first_name}}'s Availability</h6>
    </div>
    <div class="col-xs-12 col-sm-10 col-sm-offset-1 col-lg-8 col-lg-offset-2 profilebox marginbottom60px">
    	

        <div class="row">
            <h6 class="col-xs-12 col-sm-12 margintop30px marginbottom30px"> 	
            		When will your package arrive?  Select up to 6 dates....{{ host.first_name }}'s Availability is shown below... [ADD MORE TEXT ABOUT INTERPRETING CALENDAR]
            
             {% if packagedays_count %} <br> <br> You checked {{ packagedays_count }} days: {{ packagedays }} {% endif %}
            	
            </h6>
            
            <div class="row"> <!--row with the calendar-->
        				<div class="col-xs-12"> 	{% include "calendar_subtemplates/bimonthly_calendar_withcheckboxes.html" %} </div>
        				<p class="col-xs-12 textcenter">Red cells = conflict with package delivery window; grey = host unavailable; blue = package arrival window</p>    				
    				</div>
                          
        </div>
    		
    			<!--availability policy MODAL-->
    			<div class="col-xs-12 marginsides3pct marginbottom30px">
    			        <p class="darkgreytext">Please note, if you choose a date or time when the host is unavailble, we cannot guarantee reciept of delivery. For more details, please see our <a href="#openModal2" class="ltbluetext">Availability Policy</a>.</p>
    			    <div id="openModal2" class="modalDialog">
    			        <div class="modalupfront">	<a href="#close" title="Close" class="close">X</a>
    			            <h6 class="ltbluetext">Availability Policy</h6>
    			            <p class="darkgreytext marginbottom20px">Hosts are accountable for all packages delivered on days that they commmited to being available and are required to regularly update their availability. If they miss the package, you will not be charged, and the host is responsible for tracking down the missed delivery. However, if you send a package to a host that might arrive on a day when they have stated they are unavailable, you will be charged even if the host misses the delivery. You're likely to still get the package, but it may not be available for pickup until a later date.</p>
    			        </div>
    			    </div>
    			</div>
    			

    	{% endif %} <!--if no packagedays_count/ if the calendar checkboxes have not been checked -->
		
	{% endif %} <!--end if transaction form submitted -->

    			
</div>
<!--profile box-->




{% endif %} <!--end if host -->

</div>

{% endblock %}